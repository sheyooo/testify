{"version":3,"sources":["app.js","controllers/appCtrl.js","controllers/controllers.js","directives/directives.js","filters/filters.js","services/services.js"],"names":["app","angular","module","constant","config","FacebookProvider","$httpProvider","RestangularProvider","apiBase","setAppId","setBaseUrl","interceptors","push","$q","$location","$localStorage","$rootScope","Auth","request","headers","token","Authorization","response","t","replace","responseError","status","data","error","resetProfile","path","console","log","reject","run","$mdThemingProvider","myPaletteMap","extendPalette","contrastDefaultColor","contrastDarkColors","contrastLightColors","500","50","100","200","300","400","600","700","definePalette","theme","primaryPalette","default","hue-1","hue-2","hue-3","accentPalette","warnPalette","backgroundPalette","dark","$stateProvider","$urlRouterProvider","$locationProvider","appBase","state","abstract","templateUrl","url","controller","showSideNav","template","resolve","profile","$stateParams","Restangular","one","hash_id","get","views","","@web.app.dashboard.user","@web.app.dashboard","otherwise","html5Mode","enabled","requireBase","$scope","$mdSidenav","$mdMedia","$state","AppService","Me","location","user","userProfile","composingPost","tokHashId","ui","showSearch","toggleNav","which","toggle","toggleSearchBox","getCategories","then","cats","categories","originatorEv","openMenu","$mdOpenMenu","ev","logout","redirect","go","menu","link","title","icon","condition","click","menuAuth","action","getSearchResultIcon","type","searchIcons","tag","searchRepo","query","d","defer","search","getList","q","plain","promise","UXService","$document","post_stats","loading","loadPosts","load","param","getPosts","r","posts","err","toast","cat","category","Facebook","authenticated","fb_button","getLoginStatus","api","fb_logged_in","fb_name","name","loginFB","signinFB","UXLoginFB","UXSubmitLogin","loginDetails","submitLogin","signin","$mdDialog","refresh","newUser","signupFb","login","fields","show","alert","parent","element","document","querySelector","clickOutsideToClose","ariaLabel","ok","submitForm","signupForm","$valid","signup","user_profile","activities","favorites","taps","loadUserProfile","loadUserPosts","all","loadUserFavorites","loadUserTaps","hide","cancel","answer","selectedCategories","res","actives","filePostIn","id","directive","restrict","transclude","PostService","scope","this","SDeletePost","post_id","post","remove","i","map","x","indexOf","splice","CommentService","appUrl","require","attrs","SuperTPostsCtrl","CommentsUI","actions","App\\Tap","App\\Favorite","App\\Amen","App\\Comment","user_ref_activities","length","interpretation","ref_activities","l","a_t","action_type","showCommentBox","openCommentBox","comments","addComment","doCommentPost","commentBox","text","comments_count","unshift","signinModal","v","deleteComment","comment_id","comment","toggleFavorite","doFavorite","favorited","favorites_count","count","toggleTap","doTap","tapped_into","taps_count","sayAmen","doSayAmen","amen","amens_count","shareToFb","method","picture","caption","description","deletePost","$timeout","e","$mdToast","Upload","files","newPost","creating","selectCategories","evt","filePostModal","removePicture","uploadImages","finished","doUpload","file","upload","complete","result","image_id","failed","progress","Math","min","parseInt","loaded","total","forEach","composePost","anonymous","$viewValue","createPost","o","chips","value","key","sendPost","p","a","images","id_arr","trim","filter","num","out","round","factory","refreshProfile","service","$http","urlBase64Decode","str","output","window","atob","getClaimsFromToken","claims","encoded","split","JSON","parse","firstName","lastName","sex","email","avatar","setFullResponse","exp","Date","now","buildAuthProfile","u","first_name","last_name","country","saveToken","doFbLogin","fb_response","json","fb_access_token","authResponse","accessToken","tokenClaims","uid","sub","me","getElementsByClassName","targetEvent","categorySelectModal","hasBackdrop","locals","simple","content","position","hideDelay"],"mappings":"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","file":"app.js","sourcesContent":["//\"use strict\";\r\n\r\nvar app = angular.module('testify', ['ngMaterial',\r\n    'chieffancypants.loadingBar',\r\n    'ngAnimate',\r\n    'ngMessages',\r\n    'angularMoment',\r\n    'ui.router',\r\n    'ngStorage',\r\n    'restangular',\r\n    'facebook',\r\n    'ngFileUpload',\r\n    'ngTextTruncate',\r\n    'emojiApp'\r\n]);\r\n\r\n//app.constant('apiBase', \"http://localhost/testify/api\");\r\napp.constant('appUrl', \"https://testify-for-testimonies.herokuapp.com\");\r\napp.constant('appBase', \"/\");\r\napp.constant('apiBase', \"http://localhost:8000/api/v1\");\r\n//app.constant('apiBase', \"https://testify-for-testimonies.herokuapp.com/api\");\r\n\r\napp.config(function(FacebookProvider, $httpProvider, RestangularProvider, apiBase) {\r\n    FacebookProvider.setAppId(180042792329807);\r\n    RestangularProvider.setBaseUrl(apiBase);\r\n\r\n    $httpProvider.interceptors.push(['$q', '$location', '$localStorage', function($q, $location, $localStorage, $rootScope, Auth) {\r\n        return {\r\n            'request': function(config) {\r\n                config.headers = config.headers || {};\r\n                if ($localStorage.token) {\r\n                    config.headers.Authorization = 'Bearer ' + $localStorage.token;\r\n                }\r\n                return config;\r\n            },\r\n            'response': function(response) {\r\n                if (t = response.headers('Authorization')) {\r\n                    t.replace('Bearer ', '');\r\n                    $localStorage.token = t;\r\n                    //console.log(t);\r\n                }\r\n\r\n                return response;\r\n            },\r\n            'responseError': function(response) {\r\n                if (response.status === 401 || response.status === 400 || response.status === 403) {\r\n                    if (response.data.error == 'token_expired') {\r\n                        delete $localStorage.token;\r\n                        Auth.resetProfile();\r\n                        $location.path('/signin');\r\n                    } else if (response.data.error == 'token_invalid') {\r\n                        delete $localStorage.token;\r\n                        Auth.resetProfile();\r\n                        $location.path('/signin');\r\n                    } else if (response.data.error == 'Bad Authorization') {\r\n                        delete $localStorage.token;\r\n                        Auth.resetProfile();\r\n                        $location.path('/signin');\r\n                    } else if (response.data.error == 'token_not_provided') {\r\n                        delete $localStorage.token;\r\n                        Auth.resetProfile();\r\n                        $location.path('/signin');\r\n                    }\r\n\r\n\r\n\r\n                    console.log(\"Unauthorized or forbidden\");\r\n\r\n                }\r\n                return $q.reject(response);\r\n            }\r\n        };\r\n    }]);\r\n});\r\n\r\napp.run(function() {\r\n    // Cut and paste the \"Load the SDK\" code from the facebook javascript sdk page.\r\n\r\n    // Load the facebook SDK asynchronously\r\n    /*(function(d, s, id) {\r\n        var js, fjs = d.getElementsByTagName(s)[0];\r\n        if (d.getElementById(id)) {\r\n            return;\r\n        }\r\n        js = d.createElement(s);\r\n        js.id = id;\r\n        js.src = \"//connect.facebook.net/en_US/sdk.js\";\r\n        fjs.parentNode.insertBefore(js, fjs);\r\n    }(document, 'script', 'facebook-jssdk'));*/\r\n});\r\n\r\napp.config(function($mdThemingProvider) {\r\n    var myPaletteMap = $mdThemingProvider.extendPalette('blue', {\r\n\r\n        'contrastDefaultColor': 'light',\r\n        'contrastDarkColors': '200, 300',\r\n        'contrastLightColors': '500',\r\n        '500': '97B6CA',\r\n        '50': '1C3456',\r\n        '100': '5DADE0',\r\n        '200': 'e74c3c',\r\n        '300': 'FFFFFF',\r\n        '400': 'F4F4F4',\r\n        '600': '27ae60',\r\n        '700': '77777E'\r\n    });\r\n    $mdThemingProvider.definePalette('palette', myPaletteMap);\r\n    //console.log(myPaletteMap);\r\n    $mdThemingProvider.theme('default')\r\n        .primaryPalette('palette', {\r\n            'default': '500',\r\n            'hue-1': '50',\r\n            'hue-2': '100',\r\n            'hue-3': '300',\r\n        })\r\n        .accentPalette('palette', {\r\n            'default': '200',\r\n            'hue-1': '600',\r\n            'hue-2': '700'\r\n\r\n        })\r\n        .warnPalette('red', {\r\n\r\n        });\r\n\r\n    $mdThemingProvider.theme('input', 'default')\r\n        .primaryPalette('grey', {\r\n\r\n        })\r\n        .backgroundPalette('palette', {\r\n            'default': '500'\r\n        }).dark();\r\n\r\n    $mdThemingProvider.theme('search', 'default')\r\n        .primaryPalette('yellow', {\r\n\r\n        })\r\n        .backgroundPalette('palette', {\r\n            'default': '50'\r\n        }).dark();\r\n\r\n    ///$mdIconProvider.defaultFontSet(\"mdi\", \"mdi-\");\r\n});\r\n\r\napp.config(function($stateProvider, $urlRouterProvider, $locationProvider, appBase) {\r\n    $stateProvider\r\n        .state('web', {\r\n            //url: appBase,\r\n            abstract: true,\r\n            templateUrl: 'views/web.html'\r\n        }).state('web.app', {\r\n            abstract: true,\r\n            url: appBase,\r\n            templateUrl: 'views/web.app.html'\r\n        }).state('web.app.login', {\r\n            url: 'login',\r\n            templateUrl: 'views/web.app.login.html',\r\n        }).state('web.app.signup', {\r\n            url: 'signup',\r\n            controller: 'LoginCtrl',\r\n            templateUrl: 'views/web.app.signup.html',\r\n            data: {\r\n                showSideNav: false\r\n            }\r\n        }).state('web.app.logout', {\r\n            url: 'logout',\r\n\r\n            controller: 'LogoutCtrl',\r\n            template: \" \",\r\n            data: {\r\n                showSideNav: false\r\n            }\r\n        }).state('web.app.landing', {\r\n            url: '',\r\n            templateUrl: 'views/web.app.landing.html',\r\n        }).state('web.app.dashboard', {\r\n            abstract: true,\r\n            url: '',\r\n            templateUrl: 'views/web.app.dashboard.html',\r\n        }).state('web.app.dashboard.home', {\r\n            url: 'home',\r\n            templateUrl: 'views/web.app.dashboard.home.html'\r\n        }).state('web.app.dashboard.post', {\r\n            url: 'post/:hash_id',\r\n            templateUrl: 'views/web.app.dashboard.post.html'\r\n        }).state('web.app.dashboard.posts', {\r\n            url: 'posts?cat',\r\n            templateUrl: 'views/web.app.dashboard.home.html'\r\n        }).state('web.app.dashboard.user', {\r\n            url: 'user/:hash_id',\r\n            resolve: {\r\n                profile: function($stateParams, Restangular) {\r\n                    return Restangular.one('users', $stateParams.hash_id).get();\r\n                }\r\n            },\r\n            views: {\r\n                '': {\r\n                    templateUrl: \"views/web.app.dashboard.profile.html\",\r\n                    controller: 'ProfileCtrl',\r\n                },\r\n                '@web.app.dashboard.user': {\r\n                    templateUrl: 'views/web.app.dashboard.profile.activities.html',\r\n                }\r\n            }\r\n        }).state('web.app.dashboard.user.activities', {\r\n            url: '/activities',\r\n            templateUrl: 'views/web.app.dashboard.profile.activities.html',\r\n        }).state('web.app.dashboard.user.favorites', {\r\n            url: '/favorites',\r\n            templateUrl: 'views/web.app.dashboard.profile.favorites.html',\r\n        }).state('web.app.dashboard.user.taps', {\r\n            url: '/taps',\r\n            templateUrl: 'views/web.app.dashboard.profile.taps.html',\r\n        }).state('web.app.dashboard.user.edit', {\r\n            url: '/edit',\r\n            views: {\r\n                '@web.app.dashboard': {\r\n                    templateUrl: 'views/web.app.dashboard.profile.edit.html'\r\n\r\n                }\r\n            }\r\n        });\r\n\r\n    $urlRouterProvider.otherwise(appBase + \"home\");\r\n\r\n    $locationProvider.html5Mode({\r\n        enabled: true,\r\n        requireBase: false\r\n    });\r\n});\r\n","app.controller('AppCtrl', function($rootScope, $scope, $mdSidenav, $mdMedia, $location, $state, $q, AppService, Auth, Me, appBase) {\r\n    $scope.location = $location;\r\n    $scope.user = Auth.userProfile;\r\n    $scope.composingPost = false;\r\n    $scope.tokHashId = Auth.token.hash_id;\r\n    //$state.go('web.app.login');\r\n\r\n    $scope.ui = {\r\n        showSearch: false,\r\n        showSideNav: $state,\r\n        toggleNav: function(which) {\r\n            $mdSidenav(which).toggle();\r\n            //console.log(which);\r\n        },\r\n        toggleSearchBox: function() {\r\n            $scope.ui.showSearch = !$scope.ui.showSearch;\r\n        }\r\n    };\r\n    //console.log($state);\r\n    //$scope.ui.showSideNav = $state.current.data.showSideNav;\r\n    //console.log($scope.tokHashId);\r\n\r\n    AppService.getCategories.then(function(cats) {\r\n\r\n        $scope.categories = cats.data;\r\n    });\r\n\r\n\r\n    var originatorEv;\r\n    $scope.openMenu = function($mdOpenMenu, ev) {\r\n        originatorEv = ev;\r\n        $mdOpenMenu(ev);\r\n        //console.log(ev)\r\n    };\r\n\r\n    $scope.logout = function() {\r\n        Auth.logout();\r\n        //Me.callInit();\r\n        //console.log($scope.user);\r\n    };\r\n\r\n    $scope.redirect = function(state) {\r\n        $state.go(state);\r\n    };\r\n\r\n    $scope.menu = [{\r\n        link: '',\r\n        state: 'web.app.dashboard.home',\r\n        title: 'Feeds',\r\n        icon: 'home',\r\n        condition: true,\r\n        click: ''\r\n    }];\r\n\r\n    $scope.menuAuth = [{\r\n        link: 'profile',\r\n        state: \"web.app.dashboard.user({hash_id: tokHashId})\",\r\n        title: 'Profile',\r\n        icon: 'account',\r\n        condition: 'user.authenticated',\r\n        action: null\r\n    }, {\r\n        link: '',\r\n        state: 'web.app.dashboard.home',\r\n        title: 'Messages',\r\n        icon: 'message-text-outline',\r\n        condition: 'user.authenticated',\r\n        click: ''\r\n    }, {\r\n        link: 'showListBottomSheet($event)',\r\n        state: 'web.app.dashboard.user.favorites({hash_id: tokHashId})',\r\n        title: 'Favourites',\r\n        icon: 'star',\r\n        condition: 'user.authenticated',\r\n        action: null\r\n    }, {\r\n        link: 'showListBottomSheet($event)',\r\n        state: 'web.app.dashboard.settings',\r\n        title: 'Settings',\r\n        icon: 'settings',\r\n        condition: 'user.authenticated',\r\n        action: null\r\n    }];\r\n\r\n\r\n\r\n\r\n\r\n    $scope.getSearchResultIcon = function(type) {\r\n        //console.log(icon[type]);\r\n        return icon[type];\r\n    };\r\n\r\n    $scope.searchIcons = {\r\n        \"tag\": \"pound\",\r\n        \"user\": \"at\"\r\n    };\r\n\r\n\r\n\r\n    $scope.searchRepo = function(query) {\r\n        var d = $q.defer();\r\n        AppService.search.getList({\r\n            q: query\r\n        }).then(function(response) {\r\n            d.resolve(response.data.plain());\r\n            //console.log(response.data.plain());\r\n            //return result;\r\n        }, function() {\r\n            d.reject();\r\n        });\r\n\r\n        return d.promise;\r\n    };\r\n\r\n});\r\n","app.controller('PostsCtrl', ['AppService', 'Me', '$scope', '$state', '$stateParams', 'Restangular', 'UXService', '$document', function(AppService, Me, $scope, $state, $stateParams, Restangular, UXService, $document) {\r\n    $scope.app = AppService.app; //Post.getList();\r\n    $scope.post_stats = {\r\n        loading: false\r\n    };\r\n    var loadPosts = function() {\r\n        var param = null;\r\n        $scope.post_stats.loading = true;\r\n\r\n        if ($stateParams.cat) {\r\n            load({\r\n                category: $stateParams.cat\r\n            });\r\n        } else {\r\n            load({});\r\n        }\r\n\r\n\r\n        function load(param) {\r\n            AppService.getPosts.getList(param).then(function(r) {\r\n                //console.log(AppService.app);\r\n                AppService.app.posts = r.data;\r\n                /*l = r.data.length;\r\n                for (i = 0; i < l; i++) {\r\n                    AppService.app.posts.unshift(r.data[i]);\r\n                }*/\r\n\r\n                $scope.post_stats.loading = false;\r\n                //console.log(r.data.plain());\r\n            }, function(err) {\r\n                $scope.post_stats.loading = false;\r\n                //console.log(err);\r\n                UXService.toast(\"Something's wrong\");\r\n            });\r\n        }\r\n    };\r\n\r\n    loadPosts();\r\n\r\n\r\n\r\n}]);\r\n\r\napp.controller('LoginCtrl', ['$scope', 'UXService', 'Facebook', '$q', '$state', 'Auth', 'Me', 'appBase', function($scope, UXService, Facebook, $q, $state, Auth, Me, appBase) {\r\n\r\n    if (Auth.userProfile.authenticated === true) {\r\n        $state.go('web.app.dashboard.home');\r\n    }\r\n\r\n    $scope.fb_button = \"Login with Facebook\";\r\n\r\n    Facebook.getLoginStatus(function(r) {\r\n        //console.log(r);\r\n        if (r.status === 'connected') {\r\n            //console.log(r);\r\n            Facebook.api('/me', function(r) {\r\n                $scope.fb_logged_in = true;\r\n                $scope.fb_name = r.name;\r\n                $scope.fb_button = \"Continue as \" + $scope.fb_name;\r\n            });\r\n            //console.log(r);\r\n        } else {\r\n            //console.log(\"false;\");                \r\n            $scope.fb_logged_in = false;\r\n            $scope.fb_name = \"null\";\r\n            $scope.fb_button = \"Login with Facebook\";\r\n        }\r\n    });\r\n\r\n    $scope.loginFB = function() {\r\n        Auth.signinFB().then(function() {\r\n            $state.go('web.app.dashboard.home');\r\n        }, function(r) {\r\n            UXService.toast(r.data.error);\r\n        });\r\n    };\r\n\r\n    $scope.UXLoginFB = function() {\r\n        UXService.UXLoginFB();\r\n    };\r\n\r\n    $scope.UXSubmitLogin = function() {\r\n        UXService.UXSubmitLogin($scope.loginDetails);\r\n    };\r\n\r\n    var refresh = function() {\r\n        Facebook.api(\"/me\", {\r\n            fields: 'id,name,email,access_token'\r\n        }).then(\r\n            function(response) {\r\n                $scope.welcomeMsg = \"Welcome \" + response.name;\r\n                console.log(response);\r\n                //console.log(JSON.stringify(response));\r\n            },\r\n            function(err) {\r\n                $scope.welcomeMsg = \"Please log in\";\r\n            });\r\n    };\r\n\r\n    $scope.submitLogin = function() {\r\n        Auth.signin($scope.loginDetails).then(function(r) {\r\n            //console.log($scope.user);\r\n            $state.go('web.app.dashboard.home');\r\n            //Me.callInit();\r\n            //Success Login\r\n        }, function(err) {\r\n            console.log(err);\r\n            //console.log($scope.loginDetails);\r\n        });\r\n    };\r\n\r\n}]);\r\n\r\napp.controller('SignupCtrl', ['$scope', 'Facebook', 'Auth', '$location', '$mdDialog', '$state', function($scope, Facebook, Auth, $location, $mdDialog, $state) {\r\n    var refresh;\r\n\r\n    $scope.newUser = {};\r\n    $scope.signupFb = function() {\r\n        Facebook.login().then(function() {\r\n            refresh();\r\n        });\r\n    };\r\n\r\n    refresh = function() {\r\n        Facebook.api(\"/me\", {\r\n            fields: 'id,first_name,last_name,email'\r\n        }).then(\r\n            function(response) {\r\n                Facebook.logout();\r\n                //$scope.welcomeMsg = \"Welcome \" + response.name;\r\n                //console.log(response);\r\n                //console.log(JSON.stringify(response));\r\n                //Auth.BuildSession(name, id, lastname for appctrl scope);\r\n                //$location.path('/');\r\n            },\r\n            function(err) {\r\n                $mdDialog.show(\r\n                    $mdDialog.alert()\r\n                    .parent(angular.element(document.querySelector('body')))\r\n                    .clickOutsideToClose(true)\r\n                    .title('Login failed!')\r\n                    //.content('Login failed')\r\n                    .ariaLabel('Failed login')\r\n                    .ok('close')\r\n                    //.targetEvent(ev)\r\n                );\r\n\r\n                //$scope.welcomeMsg = \"Please log in\";\r\n            });\r\n    };\r\n\r\n    $scope.submitForm = function() {\r\n        //console.log($scope.newUser);\r\n        //console.log($scope.signupForm.$valid);\r\n        if ($scope.signupForm.$valid) {\r\n            Auth.signup($scope.newUser).then(\r\n                function(r) {\r\n\r\n                    $state.go('web.app.dashboard.home');\r\n                    //console.log(r);\r\n                },\r\n                function(r) {\r\n                    //console.log(r);\r\n                });\r\n        }\r\n    };\r\n\r\n}]);\r\n\r\napp.controller('LogoutCtrl', ['$scope', 'Auth', 'Me', function($scope, Auth, Me) {\r\n    Auth.logout();\r\n    //$scope.logout();\r\n    console.log(\"mayama\");\r\n}]);\r\n\r\napp.controller('ProfileCtrl', ['Restangular', '$scope', '$stateParams', '$state', function(Restangular, $scope, $stateParams, $state) {\r\n    //console.log(profile);\r\n    var user_profile = Restangular.one('users', $stateParams.hash_id);\r\n\r\n    $scope.user = {\r\n        profile: {},\r\n        activities: [],\r\n        favorites: [],\r\n        taps: []\r\n    };\r\n\r\n\r\n    var loadUserProfile = function() {\r\n        user_profile.one('profile').get().then(function(r) {\r\n            $scope.user.profile = r.data;\r\n        });\r\n    };\r\n\r\n    var loadUserPosts = function() {\r\n        user_profile.all('activities').getList().then(function(r) {\r\n            $scope.user.activities = r.data;\r\n        });\r\n    };\r\n\r\n    var loadUserFavorites = function() {\r\n        user_profile.all('favorites').getList().then(function(r) {\r\n            $scope.user.favorites = r.data;\r\n        });\r\n    };\r\n\r\n    var loadUserTaps = function() {\r\n        user_profile.all('taps').getList().then(function(r) {\r\n            $scope.user.taps = r.data;\r\n        });\r\n    };\r\n\r\n    loadUserProfile();\r\n    loadUserPosts();\r\n    loadUserFavorites();\r\n    loadUserTaps();\r\n\r\n\r\n}]);\r\n\r\napp.controller('UXModalLoginCtrl', ['$scope', '$mdDialog', function($scope, $mdDialog) {\r\n    $scope.hide = function() {\r\n        $mdDialog.hide();\r\n    };\r\n    $scope.cancel = function() {\r\n        $mdDialog.cancel();\r\n    };\r\n    $scope.answer = function(answer) {\r\n        $mdDialog.hide(answer);\r\n    };\r\n}]);\r\n\r\napp.controller('UXModalPostCategorizeCtrl', ['$scope', '$mdDialog', 'AppService', 'selectedCategories', function($scope, $mdDialog, AppService, selectedCategories) {\r\n\r\n    AppService.getCategories.then(function(res) {\r\n        $scope.categories = res.data;\r\n        console.log($scope.actives);\r\n    });\r\n    $scope.hide = function() {\r\n        $mdDialog.hide();\r\n    };\r\n    $scope.cancel = function() {\r\n        $mdDialog.cancel();\r\n    };\r\n    $scope.filePostIn = function(id) {\r\n        console.log($scope.selectedCategories);\r\n\r\n        $mdDialog.hide(id);\r\n    };\r\n}]);\r\n","app.directive('leftSidenav', [function() {\r\n\r\n    return {\r\n        restrict: 'A',\r\n        transclude: true,\r\n        replace: true,\r\n        templateUrl: 'partials/left-sidenav.html'\r\n    };\r\n}]);\r\n\r\napp.directive('rightSidenav', [function() {\r\n    return {\r\n        restrict: 'A',\r\n        transclude: true,\r\n        replace: true,\r\n        templateUrl: 'partials/right-sidenav.html'\r\n    };\r\n}]);\r\n\r\napp.directive('searchbox', [function() {\r\n    return {\r\n        restrict: 'A',\r\n        transclude: true,\r\n        replace: true,\r\n        templateUrl: 'partials/searchbox.html'\r\n    };\r\n}]);\r\n\r\napp.directive('appToolbar', [function() {\r\n    return {\r\n        restrict: 'A',\r\n        transclude: true,\r\n        replace: true,\r\n        templateUrl: 'partials/app-toolbar.html'\r\n    };\r\n}]);\r\n\r\napp.directive('appToolbarNoLogin', [function() {\r\n    return {\r\n        restrict: 'A',\r\n        transclude: true,\r\n        replace: true,\r\n        templateUrl: 'partials/app-toolbar-no-login.html'\r\n    };\r\n}]);\r\n\r\napp.directive('testifyPosts', ['PostService', function(PostService) {\r\n    return {\r\n        restrict: 'A',\r\n        transclude: true,\r\n        replace: true,\r\n        templateUrl: 'templates/Post/posts.html',\r\n        scope: {\r\n            posts: '=testifyPosts',\r\n        },\r\n        controller: function($scope) {\r\n            //console.log($scope.posts);\r\n\r\n            this.SDeletePost = function(post_id) {\r\n                PostService.post(post_id).remove().then(function(r) {\r\n                    var i = $scope.posts.map(function(x) {\r\n                            return x.id;\r\n                        })\r\n                        .indexOf(post_id);\r\n                    //console.log($scope);\r\n                    //array.splice(removeIndex, 1);\r\n                    $scope.posts.splice(i, 1);\r\n                    //scope.post = \"\";\r\n                });\r\n\r\n            };\r\n\r\n        }\r\n    };\r\n}]);\r\n\r\napp.directive('testifyPost', ['PostService', 'CommentService', 'Auth', 'UXService', 'Facebook', 'appUrl', function(PostService, CommentService, Auth, UXService, Facebook, appUrl) {\r\n    return {\r\n        restrict: 'A',\r\n        require: \"^?testifyPosts\",\r\n        scope: {\r\n            post: '=testifyPost'\r\n        },\r\n        templateUrl: 'templates/Post/post.html',\r\n        link: function(scope, element, attrs, SuperTPostsCtrl) {\r\n            scope.user = Auth.userProfile;\r\n            scope.CommentsUI = {\r\n                loading: false\r\n            };\r\n\r\n            var actions = {\r\n                'App\\\\Tap': ['tapped into', 'this post'],\r\n                'App\\\\Favorite': ['favorited', 'this post'],\r\n                'App\\\\Amen': ['said amen', 'to this post'],\r\n                'App\\\\Comment': ['commented', 'on this post']\r\n            };\r\n\r\n            if (scope.post.user_ref_activities) {\r\n                if (scope.post.user_ref_activities.length > 0) {\r\n                    interpretation = '';\r\n                    i = 0;\r\n                    var ref_activities = scope.post.user_ref_activities;\r\n                    l = scope.post.user_ref_activities.length;\r\n\r\n                    if (l == 1) {\r\n                        a_t = ref_activities[0].action_type;\r\n                        interpretation += ' ' +\r\n                            actions[a_t][0] +\r\n                            ' ' + actions[a_t][1];\r\n                    } else if (l == 2) {\r\n\r\n                        for (var action in ref_activities) {\r\n                            i++;\r\n                            a_t = ref_activities[action].action_type;\r\n\r\n                            if (i == l - 1) {\r\n                                interpretation += ' ' + actions[a_t][0];\r\n                            }\r\n\r\n                            if (i == l) {\r\n                                interpretation += ' and ' + actions[a_t][0] + ' ' + actions[a_t][1];\r\n                            }\r\n                        }\r\n                    } else if (l > 2) {\r\n                        for (var action in ref_activities) {\r\n                            i++;\r\n                            a_t = ref_activities[action].action_type;\r\n                            if (i == l - (l - 1)) {\r\n                                interpretation += ' ' + actions[a_t][0];\r\n                            } else if (i <= l - 1) {\r\n                                interpretation += ', ' + actions[a_t][0];\r\n                            } else if (l >= i) {\r\n                                interpretation += ' and ' + actions[a_t][0] + ' ' + actions[a_t][1];\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    scope.interpretation = interpretation;\r\n                }\r\n\r\n            }\r\n\r\n            var originatorEv;\r\n            scope.openMenu = function($mdOpenMenu, ev) {\r\n                originatorEv = ev;\r\n                $mdOpenMenu(ev);\r\n                //console.log(ev)\r\n            };\r\n\r\n            scope.showCommentBox = false;\r\n            scope.openCommentBox = function() {\r\n                //console.log(scope.post.post_id);\r\n                if (scope.showCommentBox === false) {\r\n                    scope.CommentsUI.loading = true;\r\n                    PostService.post(scope.post.id).getList('comments').then(function(r) {\r\n                        //console.log(r);\r\n                        scope.post.comments = r.data;\r\n                        scope.CommentsUI.loading = false;\r\n                    }, function(r) {\r\n                        scope.CommentsUI.loading = false;\r\n                    });\r\n                }\r\n                scope.showCommentBox = true;\r\n            };\r\n\r\n            scope.addComment = function(ev) {\r\n                var doCommentPost = function() {\r\n                    //console.log(Date());\r\n                    if (scope.commentBox) {\r\n                        PostService.post(scope.post.id).post('comments', {\r\n                            text: scope.commentBox\r\n                        }).then(function(r) {\r\n                            //console.log(r);\r\n\r\n                            //console.log(comment.text);\r\n                            scope.post.comments_count++;\r\n                            scope.post.comments.unshift(r.data);\r\n                            scope.commentBox = \"\";\r\n\r\n                        });\r\n                    }\r\n                };\r\n                if (Auth.userProfile.authenticated) {\r\n                    doCommentPost();\r\n                } else {\r\n                    UXService.signinModal(ev).then(function() {\r\n                        doCommentPost();\r\n                    }, function() {\r\n                        v = \"Unsuccessful login\";\r\n                    });\r\n                }\r\n            };\r\n\r\n            scope.deleteComment = function(comment_id) {\r\n                var comment = CommentService.comment(comment_id);\r\n                comment.remove().then(function(r) {\r\n                    //console.log(r);\r\n                    var i = scope.post.comments.map(function(x) {\r\n                            return x.id;\r\n                        })\r\n                        .indexOf(comment_id);\r\n                    //console.log($scope);\r\n                    //array.splice(removeIndex, 1);\r\n                    scope.post.comments.splice(i, 1);\r\n                    scope.post.comments_count--;\r\n\r\n                    //scope.post = \"\";\r\n\r\n                });\r\n            };\r\n\r\n            scope.toggleFavorite = function(ev) {\r\n                //console.log(scope.post.post_id)\r\n                var doFavorite = function() {\r\n                    if (scope.post.favorited) {\r\n                        scope.post.favorited = false;\r\n                        scope.post.favorites_count--;\r\n                        PostService.post(scope.post.id).one('favorites').remove().then(function(r) {\r\n                            //console.log(r);\r\n                            scope.post.favorited = r.data.status;\r\n                            scope.post.favorites_count = r.data.count;\r\n                        });\r\n                    } else {\r\n                        scope.post.favorited = true;\r\n                        scope.post.favorites_count++;\r\n                        PostService.post(scope.post.id).one('favorites').post().then(function(r) {\r\n                            //console.log(\"created\");\r\n                            scope.post.favorited = r.data.status;\r\n                            scope.post.favorites_count = r.data.count;\r\n                        });\r\n                    }\r\n                };\r\n                if (Auth.userProfile.authenticated) {\r\n                    doFavorite();\r\n                } else {\r\n                    UXService.signinModal(ev).then(function() {\r\n                        doFavorite();\r\n                    });\r\n\r\n                }\r\n                //console.log(scope.post);\r\n            };\r\n\r\n            scope.toggleTap = function(ev) {\r\n                //console.log(scope.post.post_id)\r\n                var doTap = function() {\r\n                    if (scope.post.tapped_into) {\r\n                        scope.post.tapped_into = false;\r\n                        scope.post.taps_count--;\r\n                        PostService.post(scope.post.id).one('taps').remove().then(function(r) {\r\n                            //console.log(r);\r\n                            scope.post.tapped_into = r.data.status;\r\n                            scope.post.taps_count = r.data.count;\r\n                        });\r\n                    } else {\r\n                        scope.post.tapped_into = true;\r\n                        scope.post.taps_count++;\r\n                        PostService.post(scope.post.id).one('taps').post().then(function(r) {\r\n                            //console.log(\"created\");\r\n                            scope.post.tapped_into = r.data.status;\r\n                            scope.post.taps_count = r.data.count;\r\n                        });\r\n                    }\r\n                };\r\n\r\n                if (Auth.userProfile.authenticated) {\r\n                    doTap();\r\n                } else {\r\n                    UXService.signinModal(ev).then(function() {\r\n                        doTap();\r\n                    });\r\n                }\r\n                //console.log(scope.post);\r\n            };\r\n\r\n            scope.sayAmen = function(ev) {\r\n                //console.log(scope.post.post_id)\r\n                var doSayAmen = function() {\r\n\r\n                    scope.post.amen = true;\r\n                    scope.post.amens_count++;\r\n                    PostService.post(scope.post.id).one('amens').post().then(function(r) {\r\n                        //console.log(\"created\");\r\n                        scope.post.amen = r.data.status;\r\n                        scope.post.amens_count = r.data.count;\r\n                    });\r\n\r\n                };\r\n                if (Auth.userProfile.authenticated) {\r\n                    doSayAmen();\r\n                } else {\r\n                    UXService.signinModal(ev).then(function() {\r\n                        doSayAmen();\r\n                    });\r\n\r\n                }\r\n            };\r\n\r\n            scope.shareToFb = function() {\r\n                Facebook.ui({\r\n                    method: 'feed',\r\n                    //link: 'https://testify-for-testimonies.herokuapp.com/api/fb-share/56',\r\n                    link: appUrl,\r\n                    picture: appUrl + '/img/testify-fb-share-pic.png',\r\n                    name: 'Testify',\r\n                    caption: 'Sharing God\\'s goodness',\r\n                    description: scope.post.text + ' (Tesfify is a community for sharing your testimonies and engaging with other people\\'s testimonies)'\r\n                }, function(response) {});\r\n            };\r\n\r\n            scope.deletePost = function() {\r\n                //scope.post = null;\r\n                SuperTPostsCtrl.SDeletePost(scope.post.id);\r\n\r\n            };\r\n        }\r\n    };\r\n}]);\r\n\r\napp.directive('myIcon', ['$timeout', function($timeout) {\r\n    return {\r\n        restrict: 'E',\r\n        scope: {\r\n            icon: \"@\"\r\n        },\r\n        replace: true,\r\n        link: function(scope, e, attrs) {\r\n            //scope.icon = scope.icon;\r\n        },\r\n        template: \"<i class='mdi mdi-{{icon}}'></i>\"\r\n    };\r\n}]);\r\n\r\napp.directive('testifyComposer', [function() {\r\n    return {\r\n        restrict: 'A',\r\n        templateUrl: 'partials/testifyComposer.html',\r\n        controller: function($scope, UXService, AppService, $mdToast, Me, Upload,\r\n            apiBase, $timeout, $document, $q) {\r\n            $scope.selectedCategories = [];\r\n            $scope.files = [];\r\n            $scope.newPost = {\r\n                creating: false\r\n            };\r\n            var categories = [];\r\n\r\n            AppService.getCategories.then(function(cats) {\r\n                $scope.categories = cats.data;\r\n\r\n                var length = $scope.categories.length;\r\n\r\n                for (var i = 0; i < length; i++) {\r\n                    if ($scope.categories[i].name == 'General') {\r\n                        $scope.selectedCategories.push($scope.categories[i]);\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n\r\n            $scope.selectCategories = function(evt) {\r\n                UXService.filePostModal(evt, $scope.selectedCategories);\r\n\r\n                //uxmodal popup or angular ui popup\r\n            };\r\n\r\n\r\n            var isUploadFinished = function() {\r\n                finished = true;\r\n\r\n                angular.forEach($scope.files, function(file, key) {\r\n                    if (file.complete !== true) {\r\n                        finished = false;\r\n                    }\r\n\r\n                });\r\n                return finished;\r\n            };\r\n\r\n            $scope.removePicture = function(i) {\r\n\r\n                $scope.files.splice(i, 1);\r\n            };\r\n\r\n            var uploadImages = function(files) {\r\n                var d = $q.defer();\r\n                var finished = [];\r\n\r\n                $scope.files = files;\r\n\r\n                var doUpload = function(file) {\r\n                    file.file = file;\r\n                    file.upload = Upload.upload({\r\n                        url: apiBase + '/images',\r\n                        data: {\r\n                            file: file\r\n                        }\r\n                    });\r\n\r\n                    file.upload.then(function(response) {\r\n                        file.complete = true;\r\n                        file.result = response.data;\r\n                        //console.log(response);\r\n                        finished.push(response.data.image_id);\r\n\r\n                        if (files.length == finished.length) {\r\n                            d.resolve(finished);\r\n                        }\r\n                    }, function(response) {\r\n                        file.failed = true;\r\n                        if (files.length == finished.length) {\r\n                            d.resolve(finished);\r\n                        }\r\n                    }, function(evt) {\r\n                        file.progress = Math.min(100, parseInt(100.0 *\r\n                            evt.loaded / evt.total));\r\n                    });\r\n                };\r\n\r\n                if (files && files.length) {\r\n                    angular.forEach(files, function(file) {\r\n                        doUpload(file);\r\n                    });\r\n\r\n\r\n                }\r\n                return d.promise;\r\n\r\n            };\r\n\r\n            $scope.composePost = function(ev) {\r\n                //post = \"\";\r\n                //console.log($scope);\r\n                post = $scope.post;\r\n                anonymous = $scope.anonymous;\r\n\r\n                if (!post) {\r\n                    post = \" \";\r\n                }\r\n\r\n                if (anonymous.$viewValue === false || anonymous === false) {\r\n                    anonymous = 0;\r\n                } else {\r\n                    anonymous = 1;\r\n                }\r\n\r\n                var createPost = function(o) {\r\n                    //console.log(Me.sendPost);\r\n                    $scope.newPost.creating = true;\r\n                    var cats = [];\r\n\r\n                    angular.forEach($scope.chips, function(value, key) {\r\n                        cats.push(value.id);\r\n                    });\r\n\r\n\r\n                    Me.sendPost({\r\n                        post: o.p,\r\n                        anonymous: o.a,\r\n                        categories: cats,\r\n                        images: o.i\r\n                    }).then(function(r) {\r\n                        $scope.newPost.creating = false;\r\n                        $scope.post = \"\";\r\n                        $scope.composingPost = false;\r\n                        $scope.files = [];\r\n                        $scope.chips = [];\r\n\r\n                        //console.log(r);\r\n                        //console.log($scope.posts);\r\n                        if (r.status === 201) {\r\n                            $scope.app.posts.unshift(r.data);\r\n                            //console.log(r.data);\r\n                        }\r\n                    }, function(r) {\r\n                        $scope.newPost.creating = false;\r\n                    });\r\n                };\r\n\r\n                if ($scope.files.length) {\r\n                    uploadImages($scope.files).then(\r\n                        function(id_arr) {\r\n                            //console.log(id_arr);\r\n                            createPost({\r\n                                p: post.trim(),\r\n                                a: anonymous,\r\n                                i: id_arr\r\n                            });\r\n                        });\r\n                } else {\r\n                    if (post.trim()) {\r\n                        createPost({\r\n                            p: post.trim(),\r\n                            a: anonymous,\r\n                            i: []\r\n                        });\r\n                    } else {\r\n                        UXService.alert(ev, \"Post can't be empty!\");\r\n                    }\r\n\r\n                }\r\n            };\r\n        }\r\n    };\r\n}]);\r\n","app.filter('socialCounter', function() {\r\n    return function(num) {\r\n        out = num;\r\n        if (num) {\r\n            if (num >= 999 && num < 999999) {\r\n                out = Math.round(num / 100) / 10 + \"K\";\r\n            } else if (num >= 999999 && num < 999999999) {\r\n                out = Math.round(num / 100000) / 10 + \"M\";\r\n            } else if (num >= 999999999) {\r\n                out = Math.round(num / 100000000) / 10 + \"B\";\r\n            }\r\n        }\r\n        return out;\r\n    };\r\n});\r\n","app.factory('AppService', ['Restangular', 'Auth', 'Me', function(Restangular, Auth, Me) {\r\n\r\n    var app = {\r\n        posts: []\r\n    };\r\n\r\n    Auth.refreshProfile().then(function(r) {\r\n        //Me.callInit();\r\n        //console.log(\"letsee\");\r\n    });\r\n    //console.log(\"appService\");\r\n\r\n    var search = Restangular.service('search');\r\n\r\n    var getPosts = Restangular.all('posts');\r\n\r\n    var getCategories = Restangular.all('categories').getList();\r\n\r\n\r\n    return {\r\n        app: app,\r\n        search: search,\r\n        getPosts: getPosts,\r\n        getCategories: getCategories\r\n\r\n    };\r\n}]);\r\n\r\napp.factory('Auth', ['$http', '$localStorage', 'Restangular', '$q', '$state', 'Facebook', function($http, $localStorage, Restangular, $q, $state, Facebook) {\r\n    var user = {\r\n        authenticated: false,\r\n        id: null,\r\n        hash_id: null,\r\n        name: \"Guest\",\r\n        firstName: \"Guest\",\r\n        lastName: \"Guest\",\r\n        sex: null,\r\n        location: null,\r\n        email: null,\r\n        avatar: \"img/guest.png\",\r\n    };\r\n\r\n    Restangular.setFullResponse(true);\r\n\r\n    function urlBase64Decode(str) {\r\n        var output = str.replace('-', '+').replace('_', '/');\r\n        switch (output.length % 4) {\r\n            case 0:\r\n                break;\r\n            case 2:\r\n                output += '==';\r\n                break;\r\n            case 3:\r\n                output += '=';\r\n                break;\r\n            default:\r\n                throw 'Illegal base64url string!';\r\n        }\r\n        return window.atob(output);\r\n    }\r\n\r\n    function getClaimsFromToken() {\r\n        var token = $localStorage.token;\r\n        var claims = {};\r\n\r\n        //console.log(token);\r\n        if (typeof token !== 'undefined') {\r\n            var encoded = token.split('.')[1];\r\n            claims = JSON.parse(urlBase64Decode(encoded));\r\n        }\r\n\r\n        return claims;\r\n    }\r\n\r\n    var refreshProfile = function() {\r\n        //console.log(\"refresh\")\r\n        //console.log(getClaimsFromToken());\r\n\r\n        var d = $q.defer();\r\n        if (getClaimsFromToken().hash_id && getClaimsFromToken().exp > Date.now() / 1000) {\r\n            //console.log(\"truthy\");\r\n            //console.log(getClaimsFromToken().hash_id);\r\n            //console.log(Date.now() / 1000);\r\n            //console.log(getClaimsFromToken().exp);\r\n\r\n            Restangular.one('users', getClaimsFromToken().hash_id).get().then(function(r) {\r\n                buildAuthProfile(r.data);\r\n                d.resolve(true);\r\n                //console.log(getClaimsFromToken().id);\r\n            }, function(r) {\r\n                if (r.status == 404) {\r\n                    resetProfile();\r\n                    //console.log(\"user not found\");\r\n                    logout();\r\n                }\r\n                d.resolve(false);\r\n\r\n            });\r\n        } else {\r\n            //console.log(Date.now() / 1000);\r\n            //console.log(getClaimsFromToken().exp);\r\n            //delete $localStorage.token;\r\n            resetProfile();\r\n        }\r\n\r\n        return d.promise;\r\n    };\r\n\r\n    var buildAuthProfile = function(u) {\r\n        //console.log(u);\r\n        user.authenticated = true;\r\n        user.id = u.id;\r\n        user.hash_id = u.hash_id;\r\n        user.name = u.first_name + ' ' + u.last_name;\r\n        user.firstName = u.first_name;\r\n        user.lastName = u.last_name;\r\n        user.sex = u.sex;\r\n        user.location = u.state + ' ' + u.country;\r\n        user.email = u.email;\r\n        user.avatar = u.avatar;\r\n    };\r\n\r\n    var saveToken = function(token) {\r\n\r\n        $localStorage.token = token;\r\n        user.token = token;\r\n    };\r\n\r\n    var signup = function(newUser) {\r\n        var d = $q.defer();\r\n\r\n        Restangular.service('signup').post(newUser).then(function(r) {\r\n            //console.log(r);\r\n            saveToken(r.data.token);\r\n            refreshProfile(); //Refresh session data here\r\n            //$scope.refreshProfile();\r\n            $state.go('web.app.dashboard.home');\r\n            d.resolve(r.data.token);\r\n        }, function() {\r\n            d.reject();\r\n        });\r\n\r\n        return d.promise;\r\n    };\r\n\r\n    var signin = function(l) {\r\n        var d = $q.defer();\r\n\r\n        Restangular.service('authenticate').post(l).then(function(r) {\r\n            //console.log(r);\r\n            saveToken(r.data.token);\r\n            refreshProfile(); //Refresh session data here\r\n            //$scope.refreshProfile();\r\n            $state.go('web.app.dashboard.home');\r\n            d.resolve(r.data.token);\r\n        }, function() {\r\n            d.reject();\r\n        });\r\n\r\n        return d.promise;\r\n    };\r\n\r\n    var signinFB = function() {\r\n        //console.log(\"loginctrl\");\r\n        var d = $q.defer();\r\n\r\n        var doFbLogin = function(fb_response) {\r\n            var d = $q.defer();\r\n            r = fb_response;\r\n            if (r.status === 'connected') {\r\n                json = {\r\n                    \"fb_access_token\": r.authResponse.accessToken\r\n                };\r\n                Restangular.service('fb-token').post(json).then(function(r) {\r\n                    saveToken(r.data.token);\r\n                    refreshProfile(); //Refresh session data here\r\n                    //console.log(r);\r\n                    d.resolve(r);\r\n                }, function(r) {\r\n                    d.reject(r);\r\n                });\r\n            } else {\r\n                d.reject();\r\n            }\r\n            return d.promise;\r\n        };\r\n\r\n        Facebook.login(function(r) {\r\n            //console.log(r);\r\n            doFbLogin(r).then(function() {\r\n                d.resolve();\r\n            }, function(r) {\r\n                d.reject(r);\r\n            });\r\n        });\r\n\r\n        return d.promise;\r\n    };\r\n\r\n    var logout = function() {\r\n        tokenClaims = {};\r\n        delete $localStorage.token;\r\n        refreshProfile();\r\n        $state.go('web.app.login');\r\n    };\r\n\r\n    var resetProfile = function() {\r\n        user.authenticated = false;\r\n        user.id = null;\r\n        user.hash_id = null;\r\n        user.name = \"Guest\";\r\n        user.firstName = \"Guest\";\r\n        user.lastName = \"Guest\";\r\n        user.sex = null;\r\n        user.location = null;\r\n        user.email = null;\r\n        user.avatar = \"img/guest.png\";\r\n    };\r\n\r\n    return {\r\n        signup: signup,\r\n        signin: signin,\r\n        signinFB: signinFB,\r\n        logout: logout,\r\n        refreshProfile: refreshProfile,\r\n        resetProfile: resetProfile,\r\n        userProfile: user,\r\n        token: getClaimsFromToken()\r\n    };\r\n}]);\r\n\r\napp.factory('Me', ['Auth', 'Restangular', '$q', function(Auth, Restangular, $q) {\r\n\r\n    var uid = Auth.token.sub;\r\n    //console.log(uid);\r\n\r\n    var me = Restangular.one('users', uid);\r\n\r\n    var sendPost = function(o) {\r\n        return Restangular.all('posts').post({\r\n            \"post\": o.post,\r\n            \"anonymous\": o.anonymous,\r\n            \"categories\": o.categories,\r\n            \"images\": o.images\r\n        });\r\n    };\r\n\r\n    return {\r\n        id: uid,\r\n        me: me,\r\n        authenticated: Auth.userProfile.authenticated,\r\n        favorites: me.all('favorites'),\r\n        profile: Auth.userProfile,\r\n        sendPost: sendPost\r\n\r\n    };\r\n}]);\r\n\r\napp.factory('PostService', ['Restangular', '$q', function(Restangular, $q) {\r\n\r\n    var posts = Restangular.all('posts');\r\n\r\n    var post = function(id) {\r\n        return Restangular.one('posts', id);\r\n    };\r\n\r\n    return {\r\n        post: post\r\n    };\r\n\r\n}]);\r\n\r\napp.factory('CommentService', ['Restangular', '$q', function(Restangular, $q) {\r\n\r\n    var posts = Restangular.all('comments');\r\n\r\n    var comment = function(id) {\r\n        return Restangular.one('comments', id);\r\n    };\r\n\r\n    return {\r\n        comment: comment\r\n    };\r\n\r\n}]);\r\n\r\napp.factory('SocialService', ['Facebook', 'Auth', function(Facebook, Auth) {\r\n\r\n\r\n    return {\r\n\r\n    };\r\n}]);\r\n\r\napp.factory('UXService', ['$mdDialog', '$mdToast', 'Auth', '$q', '$document', function($mdDialog, $mdToast, Auth, $q, $document) {\r\n\r\n    var signinModal = function(ev) {\r\n        var d = $q.defer();\r\n        $mdDialog.show({\r\n                controller: 'UXModalLoginCtrl',\r\n                templateUrl: 'partials/ux.signin.modal.html',\r\n                parent: document.getElementsByClassName(\"middle-content\"),\r\n                targetEvent: ev,\r\n                clickOutsideToClose: true\r\n            })\r\n            .then(function(res) {\r\n                d.resolve(res);\r\n            }, function() {\r\n                d.reject();\r\n            });\r\n\r\n        return d.promise;\r\n    };\r\n\r\n    var categorySelectModal = function(ev, selectedCategories) {\r\n        var d = $q.defer();\r\n        return $mdDialog.show({\r\n            controller: 'UXModalPostCategorizeCtrl',\r\n            templateUrl: 'partials/ux.post.categorize.modal.html',\r\n            hasBackdrop: false,\r\n            parent: angular.element(document.querySelector('.middle-content')),\r\n            targetEvent: ev,\r\n            locals: {\r\n                selectedCategories: selectedCategories\r\n            },\r\n            clickOutsideToClose: true\r\n        });\r\n        /*\r\n            .then(function(res) {\r\n                d.resolve(res);\r\n                //console.log(res);\r\n            }, function() {\r\n                d.reject();\r\n            });\r\n\r\n        return d.promise;*/\r\n    };\r\n\r\n    var alert = function(ev, text) {\r\n        // Appending dialog to document.body to cover sidenav in docs app\r\n        // Modal dialogs should fully cover application\r\n        // to prevent interaction outside of dialog\r\n        $mdDialog.show(\r\n            $mdDialog.alert()\r\n            .parent(angular.element(document.querySelector('body')))\r\n            .clickOutsideToClose(true)\r\n            .title(text)\r\n            //.content(text)\r\n            .ariaLabel(text)\r\n            .ok('OK')\r\n            .targetEvent(ev)\r\n        );\r\n    };\r\n\r\n    var toast = function(text) {\r\n        $mdToast.show(\r\n            $mdToast.simple()\r\n            .content(text)\r\n            .position('top left')\r\n            .parent($document[0].querySelector('body'))\r\n            .hideDelay(7000)\r\n        );\r\n\r\n    };\r\n\r\n    var UXLoginFB = function() {\r\n        Auth.signinFB().then(function() {\r\n            $mdDialog.hide(true);\r\n        }, function() {\r\n            d = \"Do nothing\";\r\n        });\r\n    };\r\n\r\n    var UXSubmitLogin = function(loginDetails) {\r\n        Auth.signin(loginDetails).then(function(r) {\r\n            $mdDialog.hide(true);\r\n        }, function(err) {\r\n            console.log(err);\r\n            //console.log($scope.loginDetails);\r\n        });\r\n    };\r\n\r\n\r\n\r\n    return {\r\n\r\n        signinModal: signinModal,\r\n        filePostModal: categorySelectModal,\r\n        alert: alert,\r\n        toast: toast,\r\n        UXLoginFB: UXLoginFB,\r\n        UXSubmitLogin: UXSubmitLogin\r\n\r\n    };\r\n}]);\r\n"],"sourceRoot":"/"}